# Cross-site Request Forgery

CSRF is an attack that forces authenticated users to submit a request to a Web application against which they are currently autheticated. CSRF attacks exploit the trust a Web application has in an authenticated user. A CSRF attack exploits a vulnerability in a Web application if it cannot differentiate between a request generated by an individual user and a request generated by a user without their consent.
## How does CSRF

An attacker's aim for carrying out a CSRF attack is to force the user to submit a state-changing request. Examples:

- Submitting or deleting a record.
- Submitting a transaction
- Purchasing a product
- Changing a password
- Sending a message

A CSRF attack targets Web applications failing to differentiate between valid requests and forged requests controlled by attacker. There are many ways for an attacker to try and exploit the CSRF vulnerability.

Example:

1. The attacker must build an exploit URL.
2. The attacker must also trick Bob into clicking the exploit URL
3. Bob needs to have an active session with samplebank.com

Let's say that the online banking application is built using the GET method to submit a transfer request. As such, Bob's request to transfer $500 to Alice might look like this

GET https://samplebank.com/onlinebanking/transfer?amount=500&accountNumber=213367 HTTP/1.1

Using varios social engineering attack methods, an attacker can trick Bob into loading the malicious URL.

Example:
```html
<img src="https://samplebank.com/onlinebanking/transfer?amount=500&accountNumber=213367"/>
```

As a result, without Bob's permission, a malicious request is sent to the online banking application. If Bod has an active session with samplebank.com, the application would treat this as an authorized amount transfer request coming from Bob.

To carray out a successful CSRF attack, consider the following:

- The success of a CSRF attack depends on a user's session with a vulnerable application. The attack will only be successful if the user is in an active session with the vulnerable application.
- An attacker must find a valid URL to maliciously craft. The URL needs to have a state-changing effect on the target application.
- An attacker also needs to find the right values for the URL parameters. Otherwise, the target application might reject the malicious request.

## How can an application prevent a CSRF attack?

To defeat a CSRF attack, applications need a way to determine if the HTTP request is legitimately generated via the application's user interface. The best way to achieve this is through a CSRF token. A CSRF token is a secure random token (challenge token) that is use to prevent CSRF attacks. The token needs to be unique per user session and should be of large random value to make it difficult to guess. 